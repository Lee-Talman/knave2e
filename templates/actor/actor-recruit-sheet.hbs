<form class="{{cssClass}} {{actor.type}}" autocomplete="off">
    <div class="sheet-container">
        <div class="npc-grid">

            {{!-- Sheet Header --}}
            <header class="header">

                {{!-- Recruit Image --}}
                <div class="image">
                    <div class="flexcol no-wrap">
                        <div class="resource-label align-center">{{localize "KNAVE2E.Portrait"}}</div>
                        <img class="rounded" src="{{actor.img}}" data-edit="img" title="{{actor.name}}" width="100%" />
                    </div>
                </div>

                {{!-- Character Header Info --}}
                <div class="info">
                    <div class="flexrow no-wrap flex-between flex-group-left dotted name">
                        <div class="resource-label flex1">{{localize "KNAVE2E.Name"}}</div>
                        <input class="transparent flex3 no-border detail name" name="name" type="text"
                            value="{{actor.name}}" placeholder="{{actor.name}}" />
                    </div>
                    <div class="grid grid-4col no-wrap flex-between flex-group-center info-2" style="margin-top: 5px;">
                        <div class="grid-span-1 flexcol no-wrap flex-group-center level">
                            <a class="resource-label actor-button check">{{localize "KNAVE2E.Level"}}</a>
                            <input class="resource-label content narrow" type="text" name="system.level"
                                value="{{system.level}}" data-dtype="Number" />
                        </div>
                        <div class="grid-span-1 flexcol no-wrap flex-group-center morale">
                            <a class="resource-label actor-button morale">{{localize "KNAVE2E.Morale"}}</a>
                            {{#if system.settings.automaticRecruits}}
                            <div class="resource-label character">{{system.morale}}</div>
                            {{else}}
                            <input class="resource-label content narrow" type="text" name="system.morale"
                                value="{{system.morale}}" data-dtype="Number" />
                            {{/if}}
                        </div>
                        <div class="grid-span-1 flexcol no-wrap flex-group-center movement">
                            <div class="resource-label">{{localize "KNAVE2E.Movement"}}</div>
                            <input class="resource-label content narrow" type="text" name="system.movement"
                                value="{{system.movement}}" data-dtype="Number" />
                        </div>
                        <div class="grid-span-1 flexcol no-wrap flex-group-center coins">
                            <div class="resource-label">{{localize "KNAVE2E.Coins"}}</div>
                            <input class="resource-label content narrow" type="text" name="system.coins"
                                value="{{system.coins}}" data-dtype="Number" />
                        </div>
                    </div>
                    <div class="grid grid-4col no-wrap flex-between flex-group-center info-2" style="margin-top: 5px;">
                        <div class="grid-span-1 flexcol no-wrap flex-group-center type">
                            <div class="resource-label">{{localize "KNAVE2E.Type"}}</div>
                            <select class="actor-select category" name="system.category">
                                {{selectOptions recruitCategories selected=system.category localize=true}}
                            </select>
                        </div>
                        <div class="grid-span-1 flexcol no-wrap flex-group-center rarity">
                            <div class="resource-label">{{localize "KNAVE2E.Rarity"}}</div>
                            {{#if (eq system.category "expert")}}
                            <select class="actor-select rarity" name="system.rarity">
                                {{selectOptions rarityCategories selected=system.rarity localize=true}}
                            </select>
                            {{else}}
                            <div class="resource-label content narrow" name="system.rarity">
                                {{localize system.rarity}}</div>
                            {{/if}}
                        </div>
                        <div class="grid-span-1 flexcol no-wrap flex-group-center cost">
                            <div class="resource-label">{{localize "KNAVE2E.Cost"}}</div>
                            {{#if system.settings.automaticRecruits}}
                            <div class="resource-label character">{{system.costPerMonth}}</div>
                            {{else}}
                            <input class="resource-label content narrow" type="text" name="system.costPerMonth"
                                value="{{system.costPerMonth}}" data-dtype="Number" />
                            {{/if}}
                        </div>
                        <div class="grid-span-1 flexcol no-wrap flex-group-center rest">
                            <button class="resource-label rounded transparent narrow actor-button rest"
                                type="button">{{localize "KNAVE2E.Rest"}}</button>
                        </div>
                    </div>
                    <div class="grid grid-4col no-wrap flex-between flex-group-center info-3" style="margin-top: 5px;">
                        <div class="grid-span-1 flexcol no-wrap flex-group-center">
                            <div class="resource-label">{{localize "KNAVE2E.HitPoints"}}</div>
                            <div class="progress-container horizontal hitPoints">
                                <div class="progress-bar">
                                    <div class="progress-fill hitPoints" style="width:{{system.hitPoints.progress}}%">
                                    </div>
                                    <input class="progress-input resource-label content" name="system.hitPoints.value"
                                        value="{{system.hitPoints.value}}" />
                                </div>
                            </div>
                        </div>
                        <div class="grid-span-1 flexcol no-wrap flex-group-center">
                            <div class="resource-label">{{localize "KNAVE2E.HitPointsMax"}}</div>
                            <input class="resource-label transparent rounded character" type="text"
                                name="system.hitPoints.max" value="{{system.hitPoints.max}}" />
                        </div>
                        <div class="grid-span-1 flexcol no-wrap flex-group-center">
                            <div class="resource-label">{{localize "KNAVE2E.ArmorClass"}}</div>
                            {{#if system.settings.automaticArmor}}
                            <div class="resource-label shield character">{{system.armorClass}}</div>
                            {{else}}
                            <input class="resource-label shield character" type="text" name="system.armorClass"
                                value="{{system.armorClass}}" data-dtype="Number" />
                            {{/if}}
                        </div>
                        <div class="grid-span-1 flexcol no-wrap flex-group-center">
                            <a class="resource-label transparent actor-button ap">{{localize "KNAVE2E.ArmorPoints"}}</a>
                            {{#if system.settings.automaticArmor}}
                            <div class="resource-label circle character">{{system.armorPoints}}</div>
                            {{else}}
                            <input class="resource-label circle character" type="text" name="system.armorPoints"
                                value="{{system.armorPoints}}" data-dtype="Number" />
                            {{/if}}
                        </div>
                    </div>
                </div>
            </header>

            {{!-- Sheet Body --}}
            <section class="sheet-body">
                <div class="resources flexrow flex-group-center" style="margin-top:10px;">
                    <div class="grid grid-3col flex-group-center">
                        <div class="resource-label grid-span-3 align-center">{{localize "KNAVE2E.Slots"}}</div>
                        <i class="fa-solid fa-weight-hanging grid-span-1 align-right"></i>
                        {{#if system.settings.automaticRecruits}}
                        <div class="resource-label grid-span-1 align-center">{{system.slots.value}} /
                            {{system.slots.max}}</div>
                        {{else}}
                        <div class="resource-label grid-span-1 align-center">{{system.slots.value}}
                            <span>/</span>
                            <input class="resource-label content character" type="text" name="system.slots.max"
                                value="{{system.slots.max}}" data-dtype="Number" />
                        </div>
                        {{/if}}
                    </div>
                    <div class="grid grid-3col flex-group-center">
                        <div class="resource-label grid-span-3 align-center">{{localize "KNAVE2E.Spells"}}</div>
                        <i class="fa-solid fa-book grid-span-1 align-right"></i>
                        {{#if system.settings.automaticRecruits}}
                        <div class="resource-label grid-span-1 align-center">{{system.spells.value}} /
                            {{system.spells.max}}</div>
                        {{else}}
                        <div class="resource-label grid-span-1 align-center">{{system.spells.value}}
                            <span>/</span>
                            <input class="resource-label content character" type="text" name="system.spells.max"
                                value="{{system.spells.max}}" data-dtype="Number" />
                        </div>
                        {{/if}}
                    </div>
                    <div class="grid grid-3col flex-group-center">
                        <div class="resource-label grid-span-3 align-center">{{localize "KNAVE2E.AmmoBow"}}</div>
                        <i class="fa-solid fa-arrow-up-long grid-span-1 align-right"></i>
                        <input class="resource-label narrow content grid-span-1 align-center" type="text"
                            name="system.ammo.arrow" value="{{system.ammo.arrow}}" data-dtype="Number" />
                    </div>
                    <div class="grid grid-3col flex-group-center">
                        <div class="resource-label grid-span-3 align-center">{{localize "KNAVE2E.Sling"}} {{localize
                            "KNAVE2E.AmmoSling"}}
                        </div>
                        <i class="fa-solid fa-baseball grid-span-1 align-right"></i>
                        <input class="resource-label narrow content grid-span-1 align-center" type="text"
                            name="system.ammo.bullet" value="{{system.ammo.bullet}}" data-dtype="Number" />
                    </div>
                </div>
                <div class="items">
                    <ol class="items-list">
                        <li class="knave-item grid grid-12col items-header">
                            <div class="resource-label item-name-header grid-span-8">{{localize "KNAVE2E.ItemName"}}
                            </div>
                            <div class="resource-label item-slots-header grid-span-1">{{localize "KNAVE2E.Slots"}}</div>
                            <div class="resource-label item-slots-header grid-span-1">{{localize
                                "KNAVE2E.QuantityAbbr"}}</div>
                            <div class="resource-label item-controls-header grid-span-2">
                                <a class="item-control item-create" title="Create item" data-type="item"><i
                                        class="fas fa-plus"></i> Add
                                    item</a>
                            </div>
                        </li>
                        {{#each items as |item id|}}
                        <li class="knave-item grid grid-12col" data-item-id="{{item._id}}">

                            <div class="item-progress-wrapper grid grid-span-12 grid-12col">
                                <div class="item-progress-fill grid grid-span-12 grid-12col"
                                    style="width: {{#if item.system.dropped}}100{{else}}{{item.system.progress}}{{/if}}%;">
                                </div>
                                <div class="item-progress-content grid grid-span-12 grid-12col">

                                    <div class="item-image"><a class="item-image item-name grid-span-1"><img
                                                src="{{item.img}}" title="{{item.name}}" width="36" height="36" /></a>
                                    </div>

                                    {{#if (eq item.type "weapon")}}
                                    <a class="item-name detail grid-span-4">{{#if item.system.dropped}}({{localize
                                        "KNAVE2E.Dropped"}})
                                        {{/if}}{{item.name}}</a>
                                    <div class="item-buttons grid-span-3 flexrow flex-group-center">
                                        <button class="item-button attack sheet" data-action="attack" type="button"
                                            title={{localize "KNAVE2E.AttackRoll" }}>{{localize
                                            "KNAVE2E.AttackAbbr"}}</button>
                                        <button class="item-button damage sheet" data-action="damage" type="button"
                                            title={{localize "KNAVE2E.DamageRoll" }}>{{localize
                                            "KNAVE2E.DamageAbbr"}}</button>
                                        <button class="item-button damage sheet" data-action="direct" type="button"
                                            title={{localize "KNAVE2E.DirectRoll" }}>{{localize
                                            "KNAVE2E.DirectAbbr"}}</button>
                                    </div>

                                    {{else}}
                                    {{#if (eq item.type "spellbook")}}
                                    <a class="item-name detail grid-span-6">{{#if item.system.dropped}}({{localize
                                        "KNAVE2E.Dropped"}})
                                        {{/if}}{{item.name}}</a>
                                    <div class="item-buttons grid-span-1 flexrow flex-group-center">
                                        <button class="item-button cast" data-action="cast" type="button">{{localize
                                            "KNAVE2E.CastAbbr"}}</button>
                                    </div>

                                    {{else}}
                                    <a class="item-name detail grid-span-7">{{#if item.system.dropped}}({{localize
                                        "KNAVE2E.Dropped"}})
                                        {{/if}}{{item.name}}</a>
                                    {{/if}}
                                    {{/if}}

                                    <div class="item-slots grid-span-1 item-prop">{{item.system.slots}}</div>
                                    <div class="item-slots grid-span-1 item-prop">
                                        <div class="grid-span-3 flexrow flex-group-center">
                                            <a class="item-toggle quantity" data-action="decrement">
                                                <i class="fas fa-caret-down"></i></a>
                                            <div class="item-prop">{{item.system.quantity}}</div>
                                            <a class="item-toggle quantity" data-action="increment">
                                                <i class="fas fa-caret-up"></i></a>
                                        </div>
                                    </div>
                                    <div class="item-controls grid-span-2">
                                        {{#if (eq item.type "weapon")}}
                                        <a class="item-toggle" data-action="break"
                                            title={{localize "KNAVE2E.BreakWeaponDetail" }}>
                                            <i
                                                class="fas {{#if item.system.broken}}fa-heart-broken{{else}}fa-heart{{/if}}"></i></a>
                                        {{/if}}
                                        {{#if (eq item.type "spellbook")}}
                                        <a class="item-toggle" data-action="cast"
                                            title={{localize "KNAVE2E.CastSpellbookDetail" }}>
                                            <i
                                                class="fas {{#if item.system.cast}}fa-book-open{{else}}fa-book{{/if}}"></i></a>
                                        {{/if}}
                                        {{#if (eq item.type "armor")}}
                                        <a class="item-toggle" data-action="equip"
                                            title={{localize "KNAVE2E.EquipArmorDetail" }}>
                                            <i
                                                class="{{#if item.system.equipped}}fas fa-shirt{{else}}far fa-shirt{{/if}}"></i></a>
                                        {{/if}}
                                        {{#if (eq item.type "lightSource")}}
                                        <a class="item-toggle" data-action="light"
                                            title={{localize "KNAVE2E.ActivateLightSourceDetail" }}>
                                            <i
                                                class="{{#if item.system.lit}}fas fa-lightbulb{{else}}far fa-lightbulb{{/if}}"></i></a>
                                        {{/if}}
                                        <a class="item-control item-edit" title="Edit Item"><i
                                                class="fas fa-edit"></i></a>
                                        <a class="item-control item-delete" title="Delete Item"><i
                                                class="fas fa-trash"></i></a>
                                    </div>
                                </div>
                            </div>
                        </li>
                        {{/each}}
                    </ol>
                </div>
            </section>
            <footer class="footer">
                <div class="flexrow no-wrap flex-group-center ">
                    <p style="font-size:smaller">Copyright &#169; 2023 <a
                            href="https://www.patreon.com/questingbeast/posts">Ben
                            Milton and Questing Beast LLC.</a> Logo Design by <a
                            href="https://www.behance.net/MindkillerINK?locale=en_US">Tim Hastings</a>.</p>
                </div>
            </footer>
        </div>
    </div>
</form>